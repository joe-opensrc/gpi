#!/bin/bash

# Godot Project Initialiser


rootDir="$( realpath $( dirname ${0} )/.. )"
projectComponentsDir="${rootDir}/project.godot.d" # hackity hackity hack 
resDir="${rootDir}/res"
dotDir="${rootDir}/dotgodot.d"

pName="${1:-$( gum input --no-show-help --prompt 'Enter A Project Name: ' --placeholder='e.g., Galaxatron' --value=${pName} )}"
pName="${pName:-$( cat /dev/urandom | tr -dc 'A-Z0-9' | fold -w 9 | head -n 1 )}"

pOutDir="./${pName}"
pOutFile="${pOutDir}/project.godot"

mkdir "${pOutDir}"

cat $( find "${projectComponentsDir}" -mindepth 1 -printf '%p\n' | sort -V ) | sed -e "s/<|PNAME|>/${pName}/" >"${pOutFile}"
rsync -au "${resDir}/" "${pOutDir}/"
rsync -au "${dotDir}/" "${pOutDir}/.godot"
# pushd "${pOutDir}"



# ---
# git init
# git-config0r

# ---
# IFS=$':'
# compats=("Forward Plus":"GL Compatibility":"Mobile")
# cMode=$( gum choose ${compats[@]} )
#echo "config/features=PackedStringArray("4.3", \"${cMode}\")"
# config/features=PackedStringArray("4.3", "Forward Plus")
# config/features=PackedStringArray("4.3", "GL Compatibility")

# config/features=PackedStringArray("4.3", "Mobile")
# [rendering]
# renderer/rendering_method="mobile"


# for i in $(sort -n project.godot.d
